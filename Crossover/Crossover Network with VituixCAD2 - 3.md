Passive Crossover Network with VituixCAD #3

ตอนนี้ จะเป็นเรื่อง ฟิลเตอร์พื้นฐาน

สารบัญ
1.  วงจรครอสโอเวอร์คืออะไร และ แนะนำ VituixCAD
2. ฟิลเตอร์พื้นฐาน
3. **วงจรครอสโอเวอร์และเฟส**
4. วงจรครอสโอเวอร์และอิมพีแดนซ์
5. เรื่องอื่น ๆ เกี่ยวกับวงจรครอสโอเวอร์

เหมือนเดิมถ้าชอบบทความแบบนี้ก็อย่าลืมกด like หรือคอมเม้นต์นะครับ
ใครมีข้อเสนอแนะหรือมีข้อสงสัยตรงไหนก็สามารถทิ้งไว้คอมเม้นต์ได้
และถ้าเห็นว่าข้อมูลของผมผิดพลาดก็สามารถเสนอแนะกันได้นะครับ

-----

 1.  วงจรครอสโอเวอร์คืออะไร และ แนะนำ VituixCAD
https://www.facebook.com/groups/791461357947350/permalink/2238738593219612

2. ฟิลเตอร์พื้นฐาน
https://www.facebook.com/groups/791461357947350/permalink/2241239796302825

บทความอื่น ๆ
https://docs.google.com/spreadsheets/d/1rxUrbgZ-fHgAC0ry7jyNlXNsLzxi6G1SH0ofxL6onEk/


1. ความสำคัญของ phase

ทบทวนความรู้มัธยมกันเล็กน้อย

เฟส (phase) เป็น วิธีการบอกตำแหน่งของคลื่นเมื่อมีการเปรียบเทียบคลื่นตั้งแต่ 2 คลื่นขึ้นไป
ถ้าคลื่นทั้งสองมีความถี่เท่ากันแต่เกิดไม่พร้อมกัน เราจะสามารถบอกความแตกต่างของคลื่นทั้งสองได้ด้วยเฟส

เฟส มี หน่วยเป็น องศา (°) ตามวงกลม โดยเริ่มจากค่า 0 (เนื่องจากเป็นกราฟ sine) ขึ้นไปจุดสูงสุด แล้วกลับลงมาผ่าน 0 แล้วไปที่จุดต่ำสุดแล้วกลับมาที่ 0 ใหม่เป็น 1 คาบ หรือครบ 360° นั่นเอง

จุดสำคัญของเฟสอยู่ที่พฤติกรรมของผลรวมของคลื่น 2 คลื่น จะต่างกันเมื่อ phase เปลี่ยนไป
เช่น

ถ้าเฟสไม่ต่างกันเลย หรือ in-phase กราฟจะสูงขึ้น 2 เท่า หรือคิดเป็น 6 dB

ถ้าเฟสต่างกัน 180° หรือ กลับ phase กันอย่างสิ้นเชิง คลื่นจะถูกหักล้างกันจนหมด กรายเป็น 0


![[xover-03-01.png]]

2. phase ในองศาต่าง ๆ

ภาพนี้แสดงให้เห็นถึงผลรวมของคลื่นความถี่เดียวกัน 2 คลื่น ที่องศาต่างกัน

จุดที่สำคัญจะเห็นว่า 

- in-phase +6 dB
- ต่างกัน 90° +3 dB
- ต่างกัน 120° +0 dB
- ถ้ามากกว่านั้นจะติดลบ 
- และคลื่นจะหายไปเลยถ้าต่างกัน 180°

![[xover-03-02.png]]

3. ตัวอย่าง phase ไม่ดี

อันนี้เป็นตัวอย่างที่ออกแบบ phase มาไม่ดี (แน่หละกลับ phase ลำโพงไปดอกนึง : P )
จะเห็นว่าเสียงประมาณ 2k Hz มันยุบหายลงไปเลย ถ้าใครมีโอกาสฟังเสียงจริง ๆ ก็จะได้ยินเสียงที่ผิดปกตินี้อย่างชัดเจน (ผมเรียกว่าตกหลุมอากาศ)

ถ้าสังเกตที่กราฟ directivity จะเห็นช่องสีน้ำเงินแล้วก็มีขอบ ๆ เขียว ๆ ซึ่งมีด้านบนและล่างด้วย ซึ่งแสดงให้เห็นว่าเสียงไม่ได้หายไปจนหมดทุกมุม ซึ่งเดี๋ยวผมอธิบายต่อไป

![[xover-03-03.png]]

4. ตัวอย่าง phase ที่ดี
รูปนี้เป็นตัวอย่างวงจรที่มี phase ที่ดี ถ้าดูที่ SPL จะเห็นสามเหลี่ยมที่เกิดการ crossover เริ่มจากประมาณ 1500 Hz - 3600 Hz จากนั้นถ้าดูที่กราฟ Phase จะเห็นว่า phase ทั้งลำโพงทั้งสองดอกซ้อนทับกันพอดี เสียงจากดอกลำโพงทั้งสองก็จะออกมา in-phase สวยงาม

ซึ่งแน่นอนว่าในความเป็นจริงนั้นทำได้ยากมาก ทั้ง L C R ที่จะหาค่าก็ยาก แถมค่าของดอกลำโพงก็ไม่ได้มาจากการวัดจริง ๆ ด้วย

![[xover-03-04.png]]

5. เกิดอะไรขึ้นถ้า phase ไม่ตรงแป๊ะ ๆ
ในความเป็นจริงสิ่งที่จาจจะเกิดขึ้นคือ เราไปสามารถออกแบบให้ phase นั้นทาบกันตลอดทั้งช่วง crossover ได้ ในตัวอย่างจะเห็นว่า phase ช่วย 5k - 8k Hz มีความแตกต่างกันพอสมควร
เมื่อมาดู Directivity ที่เกิดขึ้นตอนวัดจริง จะเห็นว่าเสียงมันเชิดขึ้นไปด้านบนไปประมาณ 8°

![[xover-03-05.png]]
MK-5
https://www.facebook.com/groups/791461357947350/permalink/1984428265317314/
https://www.facebook.com/groups/791461357947350/permalink/1984991758594298/
https://www.facebook.com/groups/791461357947350/permalink/1987059435054197/

6. interference pattern 
เหตุผลที่เสียงมันเหมือนจะเชิดขึ้นได้นั้นเกิดจาก เมื่อตำแหน่งฟังเปลี่ยนไปเสียงอาจจะเดินทางจากลำโพงแต่ละดอกมาเข้าหูผู้ฟังด้วยเวลาไม่เท่ากัน เนื่องด้วยดอกหนึ่งอยู่ไกลกว่าอีกดอกหนึ่ง

การที่ phase ของดอกลำโพงทั้งสองไม่เท่ากันนั้น จริง ๆ ก็ไม่ต่างจากการเพิ่มระยะให้ดอกอีกดอกหนึ่งอยู่ต่ำแหน่งที่ห่างออกไป หรือ กล่าวได้ว่าเสียงมี delay เพิ่มขึ้นนั่นเอง

ตัวนี้ผมแนะนำให้ทดลองด้วยตัวเองด้วย simulator ตัวนี้ (link ใน comment)

![[xover-03-06.png]]
https://wave-interference.streamlit.app/

7. รู้จัก filter ชนิดต่าง ๆ

ในการออกแบบ crossover หรือ filter ใน DSP เรามักจะชื่อเหล่านี้เช่น

- Butterworth
- Bessel
- Linkwitz-Riley
- Chebyshev
- Q-Factor

filter แต่ละตัวนี้จะต้องมี order มากกว่า 2 (1st-order มี component เดียว หน้าตา filter จะเหมือนกันหมด) ซึ่งแต่ละตัวก็จะมีลักษณะเด่นที่แตกต่างกันไป การเปรียบเทียบจะต้องเปรียบเทียบในระดับ order เดียวกัน โดยจะยกตัวอย่างเป็น 2nd-order 

ในบทความนี้ผมขอลงแค่ลักษณะเด่นของแต่ละตัว ไม่ลงลึกถึงวิธีคำนวน

![[xover-03-07.png]]

8. Butterworth

- กราฟสัญญาณจะเรียบที่สุดเท่าที่เป็นไปได้

![[xover-03-08.png]]

9. Bessel

- กราฟ phase ดีที่สุด หรือ กล่าวได้อีกอย่างว่า Group delay น้อยที่สุด
- กราฟสัญญาณจะเริ่มตกเร็วกว่า Butterworth

![[xover-03-09.png]]


10. Linkwitz-Riley (LR)

- เกิดมาสำหรับทำ crossover โดยเฉพาะ
- ไอเดียดังเดิมคือเอา Butterworth 2 ตัวมาต่อกัน ให้ระดับความดังที่จุด crossover ลดลง -6 dB จากเดิมที่ Butterworth ตัวเดียวจะลดลงแค่ -3 dB ทำให้ถ้าใช้ Butterworth เป็น crossover กราฟรวมจะสูงขึ้นมา 3dB ที่จุดตัด แต่ถ้าเป็น LR กราฟจะเรียบพอดี

![[xover-03-10.png]]

11. Chebyshev
- จะมีอยู่ 2 แบบ Type I และ Type II ในตัวอย่างนี้จะเป็น Type I ส่วน  Type II ทำ passive crossover จริงได้ยากจึงขอไม่พูดถึง
-  Chebyshev จะมีการกระเพื่อม (ripple) ทั้งใน SPL และ phase 
- จะมีการตัดความถี่ได้ดีกว่าตัวอื่น ๆ


![[xover-03-11.png]]

12. Q Factor
ในบางโปรแกรมอาจจะมีให้เราสามารถใส่ค่า Q ได้ตามใจชอบ โดยค่า Q ยิ่งน้อยกราฟก็จะเริ่มตกเร็วแต่ความชันน้อย ถ้า Q มากขึ้นจุดที่เริ่มตกลงจะยิ่งใกล้ ความถี่ filter มากขึ้น แต่ถ้า Q สูงกว่า 0.707 จะเกิดการกระเพื่อมขึ้นที่ความถี่ filter

ซึ่งจริง ๆ แล้ว filter ต่าง ๆ ที่กล่าวมาข้างต้น (2nd-order) จะมีค่า Q ดังนี้

- Butterworth = 0.707
- Bessel = 0.577
- Linkwitz-Riley = 0.5
- Chebyshev > 0.707

![[xover-03-12.png]]

13. ภาคปฏิบัติ

เริ่มจากเราไป download data file ของลำโพงที่ต้องการมาก่อน วันนี้ผมจะเลือกใช้
RS100P-4 และ ND25FW-4 จาก Dayton Audio

ให้เข้าไปที่หน้าสินค้าของ Dayton แล้วกดเลือก Data Files ซึ่งมันจะให้ download .zip มาอันนึง ให้เรา save เก็บไว้แล้วแตก zip ออกมา

ถ้าใครหาไม่เจอผมมีแปะ link ไว้ใน comment

![[xover-03-13.png]]
RS100P-4 
https://daytonaudio.com/product/1222/rs100p-4-4-reference-paper-woofer-4-ohm
ND25FW-4
https://daytonaudio.com/product/1280/nd25fw-4-1-soft-dome-neodymium-tweeter-with-waveguide-4-ohm

14. load data เข้า VituixCAD

เมื่อเราแตกไฟล์ zip ออกมา เราจะเห็นโฟรเดอร์อยู่ 5 โฟรเดอร์ แต่ให้สนใจแค่ FRD และ ZMA ก็พอ 
โดยใน FRD จะใส่ไฟล์ Frequency response ที่วัดในมุมต่าง ๆ ไว้ ให้เราเลือกทุกไฟล์ใส่เข้ามาให้หมด 
ส่วน ZMA จะเก็บไฟล์ Impedance เราก็โหลดเข้ามาใส่ใน Impedance response ให้เรียบร้อย

ทำทั้ง RS100P-4  และ ND25FW-4 ตั้งชื่อให้เรียบร้อย

![[xover-03-14.png]]

15. ปรับ delay

เนื่องจากในความเป็นจริงถ้าเราติดตั้งดอกลำโพงทั้งสองลงในกล่อง โดยให้หน้าเรียบ ๆ อยู่ในระดับเดียวกัน จุดกำเนิดเสียงจะมีระยะไม่เท่ากัน โดยผมขอสมมติว่า tweeter จะอยู่ใกล้มากกว่า woofer อยู่ที่ 6 มม. ซึ่งคิดเป็น -17 us เราก็เอาค่านี้ไปใส่ในช่อง Delay ดังรูป

ในการทำงานจริง ๆ การวัด Delay แบบนี้จะไม่ค่อยดีเท่าไหร่ ไว้ในตอนหน้าผมจะมาสอนวิธีใส่ค่า Delay ในการวัดจริง ๆ นั้นทำอย่างไร

![[xover-03-15.png]]

16. ลองเช็คความถูกต้อง

ลองต่อวงจรโดยไม่มี crossover ดูก่อน หน้าตาที่ได้ควรจะเหมือนในรูป ถ้าใครติดตรงไหนก็สามารถถามใน comment มาได้ครับ

![[xover-03-16.png]]

17. ลงมือออกแบบ

ตัวอย่างนี้ผมใส่ค่ามั่ว ๆ มันจะไม่ค่อยดีซักเท่าไหร่ 
ใครอย่างให้ผมช่วยหรือคอมเม็นต์ในการออกแบบ
ก็สามารถ print screen (ปุ่ม win+shift+S ) แล้วส่งมาใน comment

![[xover-03-17.png]]

18. เรื่อง settings
ช่วงความกว้างของ SPL ผมจะตั้งให้อยู่ในช่วง 40 dB ไม่เยอะไปกว่านั้น เพราะถ้าไกลเกินไปจะเห็นกราฟเป็นเส้นตรงก็จริงแต่ก็จะไม่มีประโยชน์อะไร วิธีปรับย่อหรือขยายให้กด ctrl ค้างแล้วหมุน scroll wheel ขอ mouse ที่แกนตั้ง

ส่วน Directivity ถ้าต้องการหน้าตาเหมือนผมให้ตั้งค่าเหมือนในรูป

![[xover-03-18.png]]